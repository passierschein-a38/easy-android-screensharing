<html>
<head>
<title>screener</title>
<script type="text/javascript" src="Broadway/Player/YUVWebGLCanvas.js" ></script>
<script type="text/javascript" src="Broadway/Player/Player.js" ></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<style>
#page{
	text-align: center ;
	width: 99% ;
}
</style>
</head>
<body>
<div id="page">
	<div id="player">
	
	</div>
<br/>
<script type="text/javascript">
p = new Player({
  useWorker: true,
  workerFile: 'Broadway/Player/Decoder.js',  
});

document.player = p;
//var player = document.getElementById("player");
//player.appendChild(p.canvas);
$('#player').append( p.canvas );

//var connection = new WebSocket('ws://78.47.15.190:5000');
var connection = new WebSocket('ws://localhost:5000');
connection.binaryType = 'arraybuffer';

connection.onopen = function () {
  console.log( 'onopen' );
};

connection.onerror = function (error) {
  console.log('WebSocket Error ' + error);
};

connection.onmessage = function (e) { 

	if( typeof e.data == 'object' ){
		var bytearray = new Uint8Array(e.data);
		document.player.decode( bytearray );  
		return;
	}else{
		var cmd = JSON.parse( e.data );

		console.log( cmd );
			
		switch( cmd.id ){
			case 100:	//shower start
				$('#player').show();
				break;
			case 200:	//shower start
				$('#player').hide();				
				break;	
		}
		
	}
};
$('#player').hide();
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script> 
</div>
</body>
</html>